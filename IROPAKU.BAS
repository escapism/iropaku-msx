10 SCREEN1:WIDTH32:COLOR15,0,1:KEYOFF:DEFINT A-Z:CLS
20 POKE &HF3DB,0: SET BEEP 4,3
30 S=0: K=0: X=0: Y=0: DX=0: DY=0: NX=32: NP=0: P=0: C=0: CL=0: CT=0: OT=0: OA=0: OB=0: K5=-255: K3=-255
40 CC=&H90: FC=&HA0: WC=&H98: NF=4: TM=20: SE$="S1 M4000 V10 O6 G32 B16"
50 DIM CS(NF+1): DIM FR(NF+1): DIM FD(NF,2)
60 AL=1: AR=30: AT=2: AB=21: R=RND(-TIME)
70 FOR I=0 TO NF: READ CS(I): NEXT
80 GOTO 1000 'PCG

130 'Start
140 GOTO 800 'Draw Border & Start
150 'Init
160 X=15: Y=9: PX=X: PY=Y: C=4: CL=NF: CT=TM: OT=-1
170 VPOKE &H2012,&HF0: VPOKE &H1800+X+32*Y,CC
180 GOTO 710 'Location Fruits
190 'Time Reset
245 TIME=0: LOCATE AR-4,AT-1: PRINT USING "###";TM;

250 'Loop
260 S=STICK(0) OR STICK(1): SA=STRIG(0) OR STRIG(1): SB=STRIG(3)
270 DX=0: DY=0
280 IF (S OR SA OR SB)=0 GOTO 320
290 ON S GOTO 701,300,703,300,705,300,707,300
300 IF OA=0 AND SA=-1 THEN C=(C+1+(C=4))MOD4: GOTO 650
310 IF OB=0 AND SB=-1 THEN C=C-1+(C=0)*-4: GOTO 650
320 OUT &HAA,5: K=NOT INP(&HA9)
330 IF C<>0 AND K AND 128 THEN C=0: GOTO 650
340 IF C<>1 AND K AND 32 THEN C=1: GOTO 650
350 IF C<>3 AND K AND 8 THEN C=3: GOTO 650
360 OUT &HAA,3: K=NOT INP(&HA9)
370 IF C<>2 AND K AND 1 THEN C=2: GOTO 650
380 IF (DX OR DY)=0 GOTO 450
390 NP=&H1800+X+DX+32*(Y+DY): NX=VPEEK(NP)
400 IF NX=32 GOTO 430
410 IF NX=&H16 OR NX=&H17 GOTO 450
420 IF NX=FR(C) THEN CL=CL-1: PLAY SE$ ELSE GOTO 550 'Relocate Fruit
430 VPOKE &H1800+X+32*Y,32: X=X+DX: Y=Y+DY: VPOKE &H1800+X+32*Y,CC
440 IF CL=0 GOTO 1400 'Game Over
450 CT=TM-TIME\60: IF CT=OT GOTO 480
460 LOCATE AR-4,AT-1: PRINT CHR$(WC); USING "###";CT;
470 OT=CT: IF CT<=0 GOTO 1300 'Time Over
480 OA=SA: OB=SB
490 GOTO 250

550 'Relocation Fruit
560 N=NX\16-10:FX=RND(1)*(AR-AL-1)+AL+1: FY=RND(1)*(AB-AT-1)+AT+1
570 P=&H1800+FX+32*FY: IF P<>NP AND VPEEK(P)=32 GOTO 600
585 FX=FX+1: IF FX=AR THEN FX=AL+1: FY=FY+1: IF FY=AB THEN FY=AT+1
590 GOTO 570
600 FD(N,0)=FX: FD(N,1)=FY: VPOKE P,FR(N): GOTO 430
621 C=2: GOTO 650
622 C=3: GOTO 650
623 C=1: GOTO 650
624 C=0: GOTO 650
625 C=(C+1+(C=4)) MOD 4: GOTO 650
626 C=C-1+(C=0)*-4: GOTO 650

650 'Color Change'
660 VPOKE &H2012, CS(C)*16: GOTO 380

700 'Move
701 DY=-1:GOTO 300
703 DX=1:GOTO 300
705 DY=1:GOTO 300
707 DX=-1:GOTO 300

710 'Location Fruit
720 FOR I=0 TO NF-1: FX=RND(1)*(AR-AL-1)+AL+1: FY=RND(1)*(AB-AT-1)+AT+1
730 P=&H1800+FX+FY*32: IF VPEEK(P)=32 GOTO 750
740 FX=FX+1: IF FX=AR THEN FX=AL+1: FY=FY+1: IF FY=AB THEN FY=AT+1: GOTO 730
750 FR(I)=FC+16*I: FD(I,0)=FX: FD(I,1)=FY
760 VPOKE P,FR(I)
780 NEXT: FR(4)=0: GOTO 190

800 'Draw Border
810 FOR I=AL+1 TO AR-1: VPOKE &H1800+I+32*AT,&H17: VPOKE &H1800+I+32*AB,&H17: NEXT
820 FOR I=AT+1 TO AB-1: VPOKE &H1800+AL+32*I,&H16: VPOKE &H1800+AR+32*I,&H16: NEXT
830 VPOKE &H1800+AL+32*AT,&H18: VPOKE &H1800+AR+32*AT,&H19: VPOKE &H1800+AL+32*AB,&H1A: VPOKE &H1800+AR+32*AB,&H1B:
840 LOCATE AL+1,AT-1: PRINT CHR$(&HA1)+CHR$(&HB1)+CHR$(&HC1)+CHR$(&HD1)
850 GOTO 1200

1000 'PCG
1010 FOR I=0 TO 7: READ D$: VPOKE CC*8+I,VAL("&B"+D$): NEXT
1020 FOR I=0 TO 7: READ D$
1030 FOR J=0 TO 3
1040 VPOKE (FC+16*J)*8+I,VAL("&B"+D$): VPOKE &H2000+(FC+16*J)\8,CS(J)*16
1050 NEXT: NEXT
1060 FOR J=0 TO 3: FOR I=0 TO 7
1070 READ D$: VPOKE (FC+16*J+1)*8+I,VAL("&B"+D$)
1080 NEXT: NEXT
1090 FOR I=0 TO 7: READ D$: VPOKE WC*8+I,VAL("&B"+D$): NEXT
1100 GOTO 130

1200 'Start
1220 LOCATE 8,10: PRINT CHR$(&HA0)+" "+CHR$(&HB0)+" IROPAKU "+CHR$(&HC0)+" "+CHR$(&HD0)
1230 LOCATE 6,12: PRINT "PRESS SPACE TO START";
1240 IF (STRIG(0) OR STRIG(1))=0 GOTO 1240
1250 LOCATE 8,10: PRINT "               "
1260 LOCATE 6,12: PRINT "                    ";
1270 BEEP: GOTO 150

1300 'Time Over
1310 PLAY "V10 T120 O5 E8 D8 C8 O4 B8 A4 G#4 A2"
1320 LOCATE 12,11: PRINT "TIME OVER";
1330 LOCATE 6,13: PRINT "PRESS SPACE TO RETRY";
1340 IF (STRIG(0) OR STRIG(1))=0 GOTO 1340
1350 LOCATE 12,11: PRINT "         ";
1360 LOCATE 6,13: PRINT "                    "
1370 GOSUB 1600 'Clear Field
1380 BEEP: GOTO 150

1400 'Game Over
1410 VPOKE &H1800+X+32*Y,32
1420 PLAY "V10 T180 O5 G16 O6 C16 E16 G4. E16 G2"
1430 LOCATE 8,10: PRINT "CONGRATULATIONS!";
1440 LOCATE 11,12: PRINT "TIME:";USING "###.##";TIME/60;
1450 LOCATE 6,14: PRINT "PRESS SPACE TO RETRY";
1460 IF (STRIG(0) OR STRIG(1))=0 GOTO 1460
1470 LOCATE 8,10: PRINT "                ";
1480 LOCATE 11,12: PRINT "           "
1490 LOCATE 6,14: PRINT "                    "
1500 BEEP: GOTO 150

1600 'Clear Field
1610 VPOKE &H1800+X+32*Y,32
1620 FOR I=0 TO NF-1: VPOKE &H1800+FD(I,0)+32*FD(I,1),32: NEXT
1630 RETURN

2000 'Color
2001 DATA 8,10,2,4,15

3000 'Character &H90
3001 DATA 01111100
3002 DATA 11111110
3003 DATA 11010110
3004 DATA 11111110
3005 DATA 11000110
3006 DATA 11111110
3007 DATA 01111100
3008 DATA 00000000

3010 'Fruit &HA0 &HB0 &HC0 &HD0
3011 DATA 00011000
3012 DATA 00010000
3013 DATA 01111100
3014 DATA 11111110
3015 DATA 11111110
3016 DATA 11111110
3017 DATA 01111100
3018 DATA 00000000

3020 'Z &HA1
3021 DATA 11111110
3022 DATA 10000010
3023 DATA 11110110
3024 DATA 11101110
3025 DATA 11011110
3026 DATA 10000010
3027 DATA 11111110
3028 DATA 00000000

3030 'X &HB1
3031 DATA 11111110
3032 DATA 10111010
3033 DATA 11010110
3034 DATA 11101110
3035 DATA 11010110
3036 DATA 10111010
3037 DATA 11111110
3038 DATA 00000000

3040 'C &HC1
3041 DATA 11111110
3042 DATA 11000110
3043 DATA 10111010
3044 DATA 10111110
3045 DATA 10111010
3046 DATA 11000110
3047 DATA 11111110
3048 DATA 00000000

3050 'V &HD1
3051 DATA 11111110
3052 DATA 10111010
3053 DATA 10111010
3054 DATA 10111010
3055 DATA 11010110
3056 DATA 11101110
3057 DATA 11111110
3058 DATA 00000000

3060 'Watch
3061 DATA 01111100
3062 DATA 11101110
3063 DATA 11101110
3064 DATA 11100010
3065 DATA 11111110
3066 DATA 11111110
3067 DATA 01111100
3068 DATA 00000000